<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calculateur de cycle menstruel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .day {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 4px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: bold;
    }
    .menstruation { background: #f48fb1; color: white; }
    .fertile { background: #81c784; color: white; }
    .nonfertile { background: #64b5f6; color: white; }
  </style>
</head>
<body class="bg-light">
  <div class="container py-4">
    <h1 class="text-center text-danger mb-4">Calculateur de cycle menstruel</h1>
    
    <form class="card p-3 shadow-sm">
      <div class="mb-3">
        <label for="lastPeriod" class="form-label">Date du premier jour des dernières règles :</label>
        <input type="date" id="lastPeriod" class="form-control">
      </div>
      
      <div class="mb-3">
        <label for="cycleLength" class="form-label">Durée moyenne du cycle (jours) :</label>
        <input type="number" id="cycleLength" class="form-control" value="28">
      </div>
      
      <button type="button" class="btn btn-danger w-100" onclick="calculateCycle()">Calculer</button>
    </form>
    
    <div id="result" class="mt-4"></div>
    <div id="calendar" class="d-flex flex-wrap justify-content-center mt-3"></div>
    
    <div class="text-center mt-3">
      <span class="badge menstruation">?? Menstruation</span>
      <span class="badge fertile">?? Fertile</span>
      <span class="badge nonfertile">?? Non fertile</span>
    </div>
  </div>
  
  <script>
    function formatDateFR(date) {
      return date.toLocaleDateString("fr-FR", {
        weekday: 'long',
        day: 'numeric',
        month: 'long',
        year: 'numeric'
      });
    }

    function calculateCycle() {
      const lastPeriod = new Date(document.getElementById('lastPeriod').value);
      const cycleLength = parseInt(document.getElementById('cycleLength').value);
      const resultDiv = document.getElementById('result');
      const calendarDiv = document.getElementById('calendar');
      calendarDiv.innerHTML = "";
      
      if (!lastPeriod || isNaN(cycleLength)) {
        resultDiv.innerHTML = `<div class="alert alert-warning">Veuillez entrer des données valides.</div>`;
        return;
      }
      
      const nextPeriod = new Date(lastPeriod);
      nextPeriod.setDate(lastPeriod.getDate() + cycleLength);
      
      const fertileStart = new Date(lastPeriod);
      fertileStart.setDate(lastPeriod.getDate() + 11);
      const fertileEnd = new Date(lastPeriod);
      fertileEnd.setDate(lastPeriod.getDate() + 17);
      
      resultDiv.innerHTML = `
        <div class="card p-3 shadow-sm">
          <p>Prochaine menstruation prévue : <strong>${formatDateFR(nextPeriod)}</strong></p>
          <p>Période fertile estimée : <strong>${formatDateFR(fertileStart)}</strong> à <strong>${formatDateFR(fertileEnd)}</strong></p>
          <p>Période non fertile : <strong>en dehors des menstruations et de la période fertile</strong></p>
        </div>
      `;
      
      // Générer un mini calendrier de 30 jours
      for (let i = 0; i < 30; i++) {
        const day = new Date(lastPeriod);
        day.setDate(lastPeriod.getDate() + i);
        const div = document.createElement("div");
        div.classList.add("day");
        div.innerText = day.getDate();
        
        if (i < 5) div.classList.add("menstruation"); // 5 jours de règles
        else if (i >= 11 && i <= 17) div.classList.add("fertile");
        else div.classList.add("nonfertile");
        
        calendarDiv.appendChild(div);
      }
    }
  </script>
</body>
</html>